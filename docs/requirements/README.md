# DeepTrader 要件定義

## 1. プロジェクト概要

DeepTraderは、AIを活用した自然言語インターフェースを持つ暗号資産トレーディングアシスタントです。トレーダーは自然言語で指示を出し、AIエージェントがその指示を理解して適切なトレーディング操作を実行します。

## 2. 主要なユーザーストーリー

### トレーダーとして：

- 自然言語で市場分析を依頼し、AIからの洞察を得たい
- チャートの時間枠や銘柄を音声や文字で簡単に切り替えたい
- AIにチャートパターンの識別を依頼したい
- トレード戦略についてAIと議論し、フィードバックを得たい
- 市場のセンチメントや関連ニュースの要約を取得したい
- AIの提案に基づいて取引を実行したい
- 過去の会話や分析を参照したい

## 3. 機能要件

### 3.1 ユーザーインターフェース

- チャットGPTライクな対話インターフェース
- リアルタイムチャート表示（LightWeight Charts使用）
- 音声入力/出力対応
- レスポンシブデザイン（デスクトップ/モバイル対応）
- ダークモード/ライトモード

### 3.2 AIエージェント（Mastra）

- 自然言語処理による指示理解
- マルチモーダル分析（テキスト、チャート画像）
- コンテキスト保持と会話の継続性
- 市場分析と予測の提供
- テクニカル分析の実行と説明
- リスク評価と資金管理アドバイス

### 3.3 チャート機能

- 複数の時間枠表示（1分、5分、15分、1時間、4時間、日、週、月）
- 複数の暗号資産ペア
- 現物/先物の切り替え
- カスタマイズ可能なインジケーター
  - 移動平均
  - RSI
  - MACD
  - ボリンジャーバンド
- その他主要インジケーター
  - 初期実装としてMACDヒストグラムを表示済み
- 描画ツール（トレンドライン、フィボナッチリトレースメントなど）
  - フリーハンド描画
  - トレンドライン
  - フィボナッチリトレースメント
- スクリーンショット作成と分析

### 3.4 トレーディング機能

- BitGet APIとの連携（初期フェーズ）
- 市場データのリアルタイム表示
- 注文作成（指値、成行、ストップ、OCO）
- ポジション管理
- 資金管理
- トレード履歴

### 3.5 リサーチ機能

- マルチソース並列検索
- オープンインタレスト分析
- 市場センチメント分析
- ニュース統合
- ソーシャルメディア分析

### 3.6 データ管理

- ユーザーアカウント管理
- AIとの会話履歴保存
- 分析結果とチャートの保存
- カスタムインジケーターと戦略の保存

## 4. 非機能要件

### 4.1 パフォーマンス

- チャートのリアルタイム更新（WebSocketを使用）
- AIレスポンスは3秒以内
- 99.9%のアップタイム

### 4.2 セキュリティ

- エンドツーエンド暗号化
- API鍵の安全な保管
- 2段階認証
- セッション管理

### 4.3 スケーラビリティ

- マイクロサービスアーキテクチャ
- クラウドネイティブデプロイメント
- 負荷分散

### 4.4 ユーザビリティ

- 直感的なUI/UX
- 初期チュートリアル
- ヘルプドキュメント
- エラーハンドリング

## 5. 技術的制約と依存関係

### 5.1 フロントエンド

- Next.js/React
- TypeScript
- Tailwind CSS
- LightWeight Charts

### 5.2 バックエンド

- Supabase
- PostgreSQL
- RESTful API
- WebSockets

### 5.3 AI/ML

- Mastra AIエージェント
- OpenAI API
- 自然言語処理
- コンピュータビジョン（チャート分析用）

### 5.4 外部API

- BitGet API（初期）
- 将来的に追加取引所（Binanceなど）
- 市場データプロバイダー

## 6. 開発方法論

### 6.1 テスト駆動開発（TDD）

- ユニットテスト
- 統合テスト
- エンドツーエンドテスト
- 自動テスト

### 6.2 ドメイン駆動設計（DDD）

- 境界付けられたコンテキスト
- エンティティとバリューオブジェクト
- ドメインサービス
- リポジトリパターン

## 7. マイルストーンとリリース計画

### フェーズ1：MVP（最小実用製品）

- 基本的なチャートUI
- 限定的なAI機能
- BitGet APIとの基本連携
- チャット機能

### フェーズ2：拡張

- 高度なチャート分析
- AIエージェントの拡張機能
- 追加のインジケーターと描画ツール
- トレード実行機能の強化

### フェーズ3：完全版

- 複数取引所サポート
- 高度なAI戦略アドバイザー
- カスタム戦略作成
- バックテスト機能

## 8. リスクと緩和策

1. **APIの制限** - 取引所APIの制限に対応するためのキャッシュと最適化
2. **AI精度** - 継続的なトレーニングと検証
3. **市場ボラティリティ** - リスク警告と取引制限
4. **規制変更** - 法的アドバイザーとの連携と迅速な適応

## 9. 評価指標

- ユーザーエンゲージメント（セッション時間、リテンション）
- AIレコメンデーションの精度
- レスポンス時間
- ユーザーフィードバック
- 取引パフォーマンス
